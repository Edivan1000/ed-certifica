<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title th:text="${modoExclusao ? 'Excluir Pedido' : (pedido.id != null ? 'Editar Pedido' : 'Novo Pedido')}"></title>
</head>

<body>
    <h1 th:text="${modoExclusao ? 'Excluir Pedido' : (pedido.id != null ? 'Editar Pedido' : 'Adicionar Novo Pedido')}">
    </h1>

    <!-- Se estiver no modo exclusão, exibe apenas os dados e botão de exclusão -->
    <div th:if="${modoExclusao}">
        <p>Tem certeza que deseja excluir o pedido de <strong th:text="${pedido.cliente.nome}"></strong>?</p>

        <ul>
            <li><strong>Data do Pedido:</strong> <span th:text="${pedido.dataPedido}"></span></li>
            <li><strong>Código do Pedido:</strong> <span th:text="${pedido.codigoPedido}"></span></li>
            <li><strong>Status:</strong> <span th:text="${pedido.statusPedido}"></span></li>
            <li><strong>Tipo de Certificado:</strong> <span th:text="${pedido.tipoCertificado}"></span></li>
            <li><strong>Cliente:</strong> <span th:text="${pedido.cliente.nome}"></span></li>
        </ul>

        <form th:action="@{/pedidos/excluir/{id}(id=${pedido.id})}" method="post">
            <button type="submit">Confirmar Exclusão</button>
        </form>
        <a th:href="@{/pedidos}">
            <button type="button">Cancelar</button>
        </a>
    </div>

    <!-- Se NÃO for exclusão, exibe formulário de criação/edição -->
    <div th:unless="${modoExclusao}">
        <form th:action="@{/pedidos/salvar}" method="post" th:object="${pedido}">
            <input type="hidden" name="id" th:value="${pedido.id}" />

            <label>Cliente:</label>
            <select th:field="*{cliente}" required>
                <option value="">Selecione um cliente</option>
                <option th:each="cliente : ${clientes}" th:value="${cliente.id}" th:text="${cliente.nome}"></option>
            </select>
            <br>

            <label>Código do Pedido:</label>
            <input type="text" th:field="*{codigoPedido}" readonly>


            <label>Data do Pedido:</label>
            <input type="date" th:field="*{dataPedido}" required>
            <br>

            <label>Status:</label>
            <select th:field="*{statusPedido}" required>
                <option value="PENDENTE">Pendente</option>
                <option value="APROVADO">Aprovado</option>
                <option value="CANCELADO">Cancelado</option>
            </select>
            <br>

            <label>Tipo de Certificado:</label>
            <select th:field="*{tipoCertificado}" required>
                <option value="A1-ARQUIVO">A1 - Arquivo</option>
                <option value="A3-TOKEN">A3 - Token</option>
                <option value="A3-SMARTCARD">A3 - SmartCard</option>
                <option value="A3-NUVEM">A3 - Nuvem</option>
            </select>

            <button type="submit" th:text="${pedido.id != null ? 'Atualizar Pedido' : 'Salvar Pedido'}"></button>
            <a th:href="@{/pedidos}">
                <button type="button">Cancelar</button>
            </a>
        </form>
    </div>
</body>
<!-- Exibir mensagens de erro e sucesso -->
<div th:if="${erro}" style="color: red; font-weight: bold; font-size: 16px; border: 2px solid red; padding: 10px;">
    <p th:text="${erro}"></p>
</div>
</html>